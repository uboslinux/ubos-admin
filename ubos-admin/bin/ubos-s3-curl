#!/bin/bash
#
# Amazon S3 requires the percent-escaping of + characters in the filename.
# This appears to go against the URL spec, but here we are. So this script
# does that, invoked with the Xfercommand in pacman.conf
#
# Copyright (C) 2014 and later, Indie Computing Corp. All rights reserved. License: see package.
#

set -e

u=$1
f=$2

if [[ $u == *'depot'*'.ubos.net'* ]]; then
    u=${u//+/%2B}
fi
echo "Downloading $u"
curl --fail-with-body --progress-bar -o $f $u
